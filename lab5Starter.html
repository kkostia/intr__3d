<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title></title>
  <script src="https://unpkg.com/three@0.149.0/build/three.min.js"></script>
</head>
<body>
  <h1>Kostiantyn Panasenko</h1>
  <script>
    const scene = new THREE.Scene();

    const camera = new THREE.PerspectiveCamera(80, innerWidth / innerHeight, 0.1, 1000);
    camera.position.set(0, 60, 120);
    camera.lookAt(0, 0, 0);

    const renderer = new THREE.WebGLRenderer();
    renderer.setSize(innerWidth, innerHeight);
    renderer.shadowMap.enabled = true;
    document.body.appendChild(renderer.domElement);

    const light = new THREE.SpotLight(0xffffff);
    light.position.set(80, 120, 80);
    light.castShadow = true;
    scene.add(light);

    const plane = new THREE.Mesh(
      new THREE.PlaneGeometry(300, 300),
      new THREE.MeshLambertMaterial({ color: 0x808080 })
    );
    plane.rotation.x = -Math.PI / 2;
    plane.position.y = -50;
    plane.receiveShadow = true;
    scene.add(plane);

    const cube = new THREE.Mesh(
      new THREE.BoxGeometry(100, 100, 100),
      new THREE.MeshLambertMaterial({ color: 0x00ffff, transparent: true, opacity: 0.2 })
    );
    scene.add(cube);

    function makeSphere(color, x) {
      const sphere = new THREE.Mesh(
        new THREE.SphereGeometry(10, 32, 16),
        new THREE.MeshLambertMaterial({ color })
      );

      sphere.position.set(x, 0, 0);
      sphere.castShadow = true;
      scene.add(sphere);

      return {
        m: sphere,
        vx: 0.6,
        vy: 0,
        vz: 0.4
      };
    }

    const s1 = makeSphere(0xffff00, -15);
    const s2 = makeSphere(0x00ff00, 15);
    const gravity = -0.4;

    function update(s) {
      s.vy += gravity;
      s.m.position.y += s.vy;
      s.m.position.x += s.vx;
      s.m.position.z += s.vz;

      if (s.m.position.y < -40) {
        s.m.position.y = -40;
        s.vy *= -0.8;
      }

      if (Math.abs(s.m.position.x) > 40) {
        s.vx *= -1;
      }

      if (Math.abs(s.m.position.z) > 40) {
        s.vz *= -1;
      }
    }

    function collide() {
      const dx = s1.m.position.x - s2.m.position.x;
      const dy = s1.m.position.y - s2.m.position.y;
      const dz = s1.m.position.z - s2.m.position.z;

      const distance = Math.sqrt(dx * dx + dy * dy + dz * dz);

      if (distance < 20) {
        s1.vx *= -1;
        s2.vx *= -1;
        s1.vy *= -1;
        s2.vy *= -1;

        const overlap = 20 - distance;
        const normal = new THREE.Vector3(dx, dy, dz).normalize();

        s1.m.position.addScaledVector(normal, overlap * 0.5);
        s2.m.position.addScaledVector(normal, -overlap * 0.5);
      }
    }

    function loop() {
      update(s1);
      update(s2);
      collide();

      renderer.render(scene, camera);
      requestAnimationFrame(loop);
    }

    loop();
  </script>
</body>
</html>
